import googlesheets_explorer as gs
import settings
from settings import admin_spreadsheet_id
from datetime import datetime, timedelta
import pytz

descriptionText = """‚òÄÔ∏è –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º –≤–∞—Å —Å –µ—â√´ –æ–¥–Ω–∏–º —à–∞–≥–æ–º –∫ —Å–µ–±–µ –Ω–∞—Å—Ç–æ—è—â–µ–º—É.

üèÑüèº‚Äç‚ôÇÔ∏è –í–∞—Å –∂–¥√´—Ç –¥–æ–ª–≥–∏–π, –∞ –º–æ–∂–µ—Ç –∏ –∫–æ—Ä–æ—Ç–∫–∏–π –ø—É—Ç—å, –≥–¥–µ –≤—ã —Å–∞–º–∏ —Ä–µ—à–∞–µ—Ç–µ –Ω–∞ –∫–∞–∫–æ–º —É—Ä–æ–≤–Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è, –Ω–∞ –∫–∞–∫–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ. –ú—ã –æ—á–µ–Ω—å —Ä–∞–¥—ã, —á—Ç–æ –≤—ã –≤—ã–±—Ä–∞–ª–∏ –∏–º–µ–Ω–Ω–æ –Ω–∞—Å –≤ —Å–≤–æ–∏ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–∏ –∫ —Å–µ–±–µ, —Å–≤–æ–µ–π –º–µ—á—Ç–µ, —Å–≤–æ–µ–º—É —Å—á–∞—Å—Ç—å—é. 

–î–ª—è –≤–∞—Å –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ 3 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥:
‚ö´Ô∏è black
‚ö™Ô∏è silver / silver premium
üü° gold / gold premium
–∫–∞–∂–¥–∞—è –∏–∑ –Ω–∏—Ö –∏–º–µ–µ—Ç —Å–≤–æ—é —Ü–µ–Ω–Ω–æ—Å—Ç—å –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.

–í—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –∫–∞–∂–¥—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–æ–ø–ª–∞—Ç–∞ —É—Å–ª—É–≥¬ª –∏ –≤—ã–±—Ä–∞—Ç—å —Å–∞–º—ã–π –ø–æ–¥—Ö–æ–¥—è—â–∏–π.

–ñ–µ–ª–∞–µ–º –≤–∞–º —Ö–æ—Ä–æ—à–æ–≥–æ –¥–Ω—è, –æ—Ç–ª–∏—á–Ω–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è, —Å–∏–ª –∏ –∑–¥–æ—Ä–æ–≤—å—è) 
–î–∞–ª—å—à–µ —Ç–æ–ª—å–∫–æ –ª—É—á—à–µ!"""

mainMenuText = "<b>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</b>"

aboutUsText = "‚úÖ –ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ \"–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å\" - –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ª—é–¥–µ–π –æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏, " \
              "—Å–ª–æ–º–∞—Ç—å —Å—Ç–µ—Ä–µ–æ—Ç–∏–ø—ã –æ–± –∏–¥–µ–∞–ª—å–Ω–æ–º –ø—Å–∏—Ö–æ–ª–æ–≥–µ, —Ä–∞–∑–≤–µ—è—Ç—å –º–µ–º –æ –∫—É—à–µ—Ç–∫–µ –∏ –æ –±–µ–∑—Ä–µ–∑—É–ª—å—Ç–∞—Ç–Ω–æ–π —Ç—Ä–∞—Ç–µ —Å–≤–æ–∏—Ö " \
              "–¥–µ–Ω–µ–≥ –≤ —Ç–µ—á–µ–Ω–∏–µ 5-10 –ª–µ—Ç. \n\n" \
              "üè§ –ó–¥–µ—Å—å –∫–∞–∂–¥—ã–π —Å–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –¥–ª—è —Å–µ–±—è —Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —É–ª—É—á—à–∏—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∂–∏–∑–Ω–∏, " \
              "–≤—ã–≤–µ–¥–µ—Ç –µ–≥–æ –∏–∑ –¥–Ω—è —Å—É—Ä–∫–∞, –ø–æ–∑–≤–æ–ª–∏—Ç –∂–∏—Ç—å, –∞ –Ω–µ –≤—ã–∂–∏–≤–∞—Ç—å. –ü—Å–∏—Ö–æ–ª–æ–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–º–æ–≥–∞–µ—Ç üòå"

enterCodeText = "‚úèÔ∏è –í–≤–µ–¥–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∫–æ–¥ —Å –∫–∞—Ä—Ç—ã, –ø—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω–Ω–æ–π –≤–∞–º–∏ —Ä–∞–Ω–µ–µ.\n\n" \
                 "‚úÖ –°—Ä–∞–∑—É –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫–æ–¥–∞ –Ω–∞ –≤–∞—à —Å—á–µ—Ç –±—É–¥–µ—Ç –∑–∞—á–∏—Å–ª–µ–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —É—Å–ª—É–≥–∞"

chooseService = "üîñ –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É:\n\n" \
                "‚ùó –ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ –≤—ã –º–æ–∂–µ—Ç–µ \n–ø–æ–ª—É—á–∏—Ç—å, –Ω–∞–∂–∞–≤ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–Ω–æ–ø–∫—É —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º " \
                "—É—Å–ª—É–≥–∏"

useYorServicesBeforeActivate = "‚ùó –ü–µ—Ä–µ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞, –∑–∞–ø–∏—à–∏—Ç–µ—Å—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é " \
                               "–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É\n\nüìé –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —É—Å–ª—É–≥–µ –º–æ–∂–Ω–æ " \
                               "–ø–æ–ª—É—á–∏—Ç—å, –∑–∞–π–¥—è –≤–æ –≤–∫–ª–∞–¥–∫—É \"–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å\""

useYorServicesBeforePay = "‚ùó –ü–µ—Ä–µ–¥ –æ–ø–ª–∞—Ç–æ–π, –∑–∞–ø–∏—à–∏—Ç–µ—Å—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é " \
                          "–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É\n\nüìé –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —É—Å–ª—É–≥–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, " \
                          "–∑–∞–π–¥—è –≤–æ –≤–∫–ª–∞–¥–∫—É \"–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å\""

enterYourInfo = "üìù –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –≤–∞–º –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ\n\n" \
                "‚ùó –í–≤–µ–¥–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤–æ –≤–∫–ª–∞–¥–∫–µ \"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ\" –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é"

askQuestionText = "‚ùì –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –∞–Ω–æ–Ω–∏–º–Ω–æ –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å, –æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω –≤ –Ω–∞—à–µ–º —Ç–µ–ª–µ–≥—Ä–∞–º" \
                  " –∫–∞–Ω–∞–ª–µ –≤ –ø–æ—Ä—è–¥–∫–µ –æ—á–µ—Ä–µ–¥–∏\n\n" \
                  "‚ùó –ü—Ä—è–º–æ —Å–µ–π—á–∞—Å –≤—ã –º–æ–∂–µ—Ç–µ –≤–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç —Å–≤–æ–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞"

questionPassed = "‚úÖ –í–∞—à –≤–æ–ø—Ä–æ—Å –ø—Ä–∏–Ω—è—Ç, –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –Ω–µ–≥–æ –∫–∞–∫ –º–æ–∂–Ω–æ —Å–∫–æ—Ä–µ–µ"

signedUpOnConsultation = "‚úÖ –í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é"

enterFullName = "–í–≤–µ–¥–∏—Ç–µ –§–ò–û"
enterPhoneNumber = "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞"

reenter = "–í–≤–µ–¥–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –µ—â—ë —Ä–∞–∑"
infoUpdated = "‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞.\n\n" \
              "–¢–µ–ø–µ—Ä—å –≤–∞–º –¥–æ—Å—Ç—É–ø–Ω—ã –æ–ø–ª–∞—Ç–∞ —É—Å–ª—É–≥ –∏ –≤–≤–æ–¥ –∫–æ–¥–∞ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é"

scheduleUpdated = "‚úÖ –í–∞—à–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞"

card_description = {'BLACK': """‚ö´Ô∏è <b>–§–æ—Ä–º–∞—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ¬´Black¬ª</b>

–ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥–æ–π–¥√´—Ç –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º —Ü–µ–Ω—Ç—Ä–æ–º ¬´–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å¬ª –∏ —Å –ø—Å–∏—Ö–æ–ª–æ–≥–∏–µ–π –≤ —Ü–µ–ª–æ–º. 

‚úîÔ∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 30-40–º
‚úîÔ∏è–§–æ—Ä–º–∞—Ç: –æ–Ω–ª–∞–π–Ω
‚úîÔ∏è1 –ø–æ—Å–µ—â–µ–Ω–∏–µ

–ß—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç–µ:
–ú—ã –≤—ã—è–≤–∏–º —Å—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã. –£ –≤–∞—Å –ø–æ—è–≤–∏—Ç—Å—è –æ—Å–Ω–æ–≤–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ä–∞–±–æ—Ç–æ–∫- –ø–æ–Ω–∏–º–∞–Ω–∏–µ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø—É—Ç—å —Ä–µ—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞.
–í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–∏–∏ –ø–æ–¥–æ–±–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—è—Ü–µ–≤.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–æ–π —É—Å–ª—É–≥–æ–π, –ø–µ—Ä–µ–¥ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–µ–º –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤.\n\n""",

                    'SILVER': """‚ö™Ô∏è <b>–§–æ—Ä–º–∞—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ¬´Silver¬ª</b>

–æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥–æ–π–¥—ë—Ç, –µ—Å–ª–∏ –≤—ã –≤ —Ü–µ–ª–æ–º –¥–æ–≤–æ–ª—å–Ω—ã —Å–≤–æ–µ–π –∂–∏–∑–Ω—å—é, –Ω–æ —á—Ç–æ-—Ç–æ –º–µ—à–∞–µ—Ç, –±–µ—Å–ø–æ–∫–æ–∏—Ç. –¢–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º —ç—Ç–æ—Ç —Ñ–æ—Ä–º–∞—Ç –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ —Å–∏–ª –∏ —ç–Ω–µ—Ä–≥–∏–∏.

‚úîÔ∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1 —á–∞—Å
‚úîÔ∏è–§–æ—Ä–º–∞—Ç: –æ–Ω–ª–∞–π–Ω
‚úîÔ∏è1 –ø–æ—Å–µ—â–µ–Ω–∏–µ

–ß—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç–µ:
–í—ã –ø–æ–ª—É—á–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–≤–æ–∏—Ö —Å–∏–ª –∏ –æ–±—Ä–µ—Ç–µ–Ω–∏—è —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è. –ù–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å —ç–Ω–µ—Ä–≥–∏–µ–π. –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —Å–∏–ª—ã, –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–¥—É–º–∞–Ω–Ω–æ–≥–æ. –ò–∑–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.\n\n""",

                    'GOLD': """üü° <b>–§–æ—Ä–º–∞—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ¬´Gold¬ª</b>

–û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª–Ω–∏—Ç—å —Å–≤–æ–∏ –º–µ—á—Ç—ã, —Å–∞–º—ã–µ –∑–∞–≤–µ—Ç–Ω—ã–µ –∏–¥–µ–∏. –≠—Ç–∞ —É—Å–ª—É–≥–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∂–∏–∑–Ω–∏ –∞ —Ç–µ–º–∞—Ö —Å–µ–º—å–∏, —Ä–∞–±–æ—Ç—ã, –¥–µ–Ω–µ–≥, –æ—Ç–Ω–æ—à–µ–Ω–∏–π, –ø—Ä–∏–∑–≤–∞–Ω–∏—è. 

‚úîÔ∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1 —á–∞—Å
‚úîÔ∏è–§–æ—Ä–º–∞—Ç: –æ–Ω–ª–∞–π–Ω, –æ—á–Ω–æ
‚úîÔ∏è1 –ø–æ—Å–µ—â–µ–Ω–∏–µ

–ß—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç–µ:

–ü–æ–º–æ–∂–µ–º –Ω–∞–π—Ç–∏ –≤–∞—à —Å–º—ã—Å–ª –∂–∏–∑–Ω–∏. –ü—Ä–æ–∏–∑–æ–π–¥—ë—Ç –∑–∞–ø—É—Å–∫ –ø–µ—Ä–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–π –Ω–∞ —Å–∞–º—ã—Ö –≥–ª—É–±–∏–Ω–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –ø—Å–∏—Ö–∏–∫–∏, –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–µ–¥–ø–∏—Å–∞–Ω–∏–π, –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∞ —Ä–æ–¥–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–π, –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–±–µ–∂–¥–µ–Ω–∏—è, —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –≤–∞—à–µ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞, –≤—ã—è–≤–ª–µ–Ω–∏–µ –∏ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤ –Ω–∞—á–∞–ª–µ –ø–æ—Å–µ—Ç–∏—Ç—å¬† –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —É—Å–ª—É–≥–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ Black, Silver –∏–ª–∏ Silver Premium. 


*–ø—Ä–∏ –æ—á–Ω–æ–π –≤—Å—Ç—Ä–µ—á–µ, —Å –≤–∞–º–∏ —Å–≤—è–∂–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –∏ –≤—ã—à–ª–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–∞–±–∏–Ω–µ—Ç–∞ –∏ –≤—Å—é –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.\n\n""",
                    'SILVER Premium': """‚¨úÔ∏è <b>–§–æ—Ä–º–∞—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ¬´Silver Premium. –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ¬ª</b>

 "–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ" –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏, –µ—Å–ª–∏ –≤—ã –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Å–∏–ª –¥–ª—è –∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–Ω—ã—Ö —Ü–µ–ª–µ–π.

–û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∏ —Å–ª–æ–∂–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏, –≤—ã—Ä–∞–±–æ—Ç–∫—É —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è, –æ–±—Ä–µ—Ç–µ–Ω–∏–µ¬† —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏. 

‚úîÔ∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1 —á–∞—Å
‚úîÔ∏è–§–æ—Ä–º–∞—Ç: –æ–Ω–ª–∞–π–Ω, –∞—É–¥–∏–æ
‚úîÔ∏è4 –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ( 1 –≤ –Ω–µ–¥–µ–ª—é)
‚úîÔ∏è4 —Å–æ–∑–≤–æ–Ω –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 10-15 –º–∏–Ω—É—Ç (1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)

–ß—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç–µ:

–û–ø—ã—Ç–Ω—ã–π –ø—Å–∏—Ö–æ–ª–æ–≥ –ø–æ–º–æ–∂–µ—Ç –í–∞–º —Å –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π —Ü–µ–ª–∏, –ø–æ–¥–±–µ—Ä–µ—Ç —Ç–µ—Ö–Ω–∏–∫–∏ –ø–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–º—É –ø–ª–∞–Ω—É. 

–í–æ –≤—Ä–µ–º—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤, –≤–∞—à –ø—Å–∏—Ö–æ–ª–æ–≥ –ø–æ–º–æ–∂–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –ø–æ–¥–µ–ª–∏—Ç—Å—è —Å–≤–æ–∏–º–∏ —Å–∏–ª–∞–º–∏ –∏ –∑–Ω–∞–Ω–∏—è–º–∏, –Ω–∞—Å—Ç—Ä–æ–µ–º.

–í —ç—Ç–æ–π —É—Å–ª—É–≥–µ –∞–∫—Ü–µ–Ω—Ç —Å—Ç–∞–≤–∏—Ç—Å—è –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π, –º–µ—à–∞—é—â–∏—Ö –ø–æ–ª—É—á–∏—Ç—å –∂–µ–ª–∞–µ–º–æ–µ, —É–ª—É—á—à–µ–Ω–∏–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è, –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –∏ —Å–∏–ª.\n\n""",
                    'GOLD Premium': """üü® <b>–§–æ—Ä–º–∞—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ¬´Gold Premium. –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ¬ª</b>

–î–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç- —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç—å —Å–≤–æ–∏ –º–µ—á—Ç—ã, –ø–æ–Ω—è—Ç—å, –≤ —á–µ–º –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤–∞—à–∞ –æ–¥–∞—Ä—ë–Ω–Ω–æ—Å—Ç—å –∏ —Å–º—ã—Å–ª.

‚úîÔ∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1 —á–∞—Å
‚úîÔ∏è–§–æ—Ä–º–∞—Ç: –æ–Ω–ª–∞–π–Ω, –∞—É–¥–∏–æ
‚úîÔ∏è4 –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ( 1 –≤ –Ω–µ–¥–µ–ª—é)
‚úîÔ∏è4 —Å–æ–∑–≤–æ–Ω –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 10-15 –º–∏–Ω—É—Ç (1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)
‚úîÔ∏è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–Ω–æ—Å–∞ 1 –≤—Å—Ç—Ä–µ—á–∏ 
‚úîÔ∏è –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã 

–ß—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç–µ:

–ß–µ—Ä–µ–∑ –ø–µ—Ä–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–∞–º—ã—Ö –≥–ª—É–±–∏–Ω–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –ø—Å–∏—Ö–æ–ª–æ–≥ –ø—Ä–æ–≤–µ–¥—ë—Ç –≤–∞—Å –∫ —Å–µ–±–µ –Ω–∞—Å—Ç–æ—è—â–µ–º—É. –ü—Ä–æ–∏–∑–æ–π–¥—ë—Ç  –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–µ–¥–ø–∏—Å–∞–Ω–∏–π, –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∞ —Ä–æ–¥–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–π, –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–±–µ–∂–¥–µ–Ω–∏—è, —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –≤–∞—à–µ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞, –≤—ã—è–≤–ª–µ–Ω–∏–µ –∏ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π.

*–ø—Ä–∏ –æ—á–Ω–æ–π –≤—Å—Ç—Ä–µ—á–µ, —Å –≤–∞–º–∏ —Å–≤—è–∂–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –∏ –≤—ã—à–ª–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–∞–±–∏–Ω–µ—Ç–∞ –∏ –≤—Å—é –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.\n\n""",}  # –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ä—Ç


haveNotPayedServices = "–£ –≤–∞—Å –µ—â–µ –Ω–µ—Ç –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —É—Å–ª—É–≥. –ß—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å—Å—è, –≤–∞–º –Ω—É–∂–Ω–æ –ª–∏–±–æ –≤–≤–µ—Å—Ç–∏ –ø—Ä–æ–º–æ–∫–æ–¥, –ª–∏–±–æ " \
                       "–æ–ø–ª–∞—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é –≤–∞—Å —É—Å–ª—É–≥—É –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é"

chooseAppointmentDate = "–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É"


#  —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ"
def client_info(user_id):
    user_ids = gs.read_values(admin_spreadsheet_id, "–ö–ª–∏–µ–Ω—Ç—ã", "COLUMNS", "A1", "A5000")[0]

    if str(user_id) in user_ids:
        user_index = user_ids.index(str(user_id)) + 1
        user_info = gs.read_values(admin_spreadsheet_id, "–ö–ª–∏–µ–Ω—Ç—ã", "ROWS", f"A{user_index}", f"G{user_index}")[0]

        message = f"<b>üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å:</b>\n\n" \
                  f"<b>ID: </b>{user_id}\n" \
                  f"<b>–§–ò–û: </b>{user_info[1]}\n" \
                  f"<b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> {user_info[2]}\n"
        if len(user_info) > 4:
            if int(user_info[5]) == 1:
                message += f"\nüìå –£ –≤–∞—Å –æ—Å—Ç–∞–ª–æ—Å—å {user_info[5]} –ø–æ—Å–µ—â–µ–Ω–∏–µ –ø–æ {user_info[4]} –∫–∞—Ä—Ç–µ\n"
            else:
                message += f"\nüìå –£ –≤–∞—Å –æ—Å—Ç–∞–ª–æ—Å—å {user_info[5]} –ø–æ—Å–µ—â–µ–Ω–∏—è –ø–æ {user_info[4]} –∫–∞—Ä—Ç–µ\n"
        message += "\n‚ùóÔ∏è–ï—Å–ª–∏ –≤–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ –∏—Ö"
        return message
    else:
        return enterYourInfo


def reschedule_message(user_id):
    message = "–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –≤—ã –±—ã —Ö–æ—Ç–µ–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏: \n"
    notes = gs.read_values(settings.admin_spreadsheet_id, "–ó–∞–ø–∏—Å—å", "ROWS", "A2", "E20000")
    i = 2
    future_consultations = []
    future_consultations_indexes = []
    try:
        for note in notes:
            if note[3] == str(user_id):
                date = note[0].split(".")
                time = note[1].split(":")

                full_date = datetime(day=int(date[0]), month=int(date[1]), year=int(date[2]), hour=int(time[0]),
                                     minute=int(time[1]))

                if full_date - datetime.now(pytz.timezone('Europe/Moscow')).replace(tzinfo=None) > timedelta(days=1):
                    future_consultations.append(note)
                    future_consultations_indexes.append(i)
                i += 1
    except:
        pass
    i = 1
    if len(future_consultations) > 0:
        for consultation in future_consultations:
            message += f"\n{i}. {consultation[0]} | {consultation[1]} - {consultation[4]}"
            i += 1
    else:
        return "–£ –≤–∞—Å –Ω–µ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ (–ø–µ—Ä–µ–Ω–æ—Å –≤–æ–∑–º–æ–∂–µ–Ω –Ω–µ –ø–æ–∑–¥–Ω–µ–µ, —á–µ–º –∑–∞ 24 —á–∞—Å–∞)", [], []
    return message, future_consultations_indexes, future_consultations


def accept_message(date, time, service):
    message = f"‚ú¥Ô∏è <b>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏:</b>\n\n " \
              f"üìÜ –î–∞—Ç–∞: {date}\n" \
              f"üïó –í—Ä–µ–º—è: {time}\n" \
              f"üîñ –£—Å–ª—É–≥–∞: {service}\n"
    return message


def user_alert(time, service):
    return f"‚ùï –ù–∞–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ —Å–µ–≥–æ–¥–Ω—è –≤ {time} –≤—ã –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ {service}"


def my_appointments(user_id):
    notes = gs.read_values(settings.admin_spreadsheet_id, "–ó–∞–ø–∏—Å—å", "ROWS", "A2", "E20000")
    message = "üìë <b>–í–∞—à–∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏:</b>\n\n"
    nearest_consultation_time = datetime(year=4000, month=12, day=31) - \
                                datetime.now(pytz.timezone('Europe/Moscow')).replace(tzinfo=None)
    nearest_consultation = []
    last_consultations = []
    future_consultations = []
    try:
        for note in notes:
            if note[3] == str(user_id):
                date = note[0].split(".")
                time = note[1].split(":")
                full_date = datetime(day=int(date[0]), month=int(date[1]), year=int(date[2]), hour=int(time[0]),
                                     minute=int(time[1]))
                if full_date < datetime.now(pytz.timezone('Europe/Moscow')).replace(tzinfo=None):
                    last_consultations.append(note)
                else:

                    if full_date - datetime.now(pytz.timezone('Europe/Moscow')).replace(tzinfo=None) \
                            < nearest_consultation_time:
                        nearest_consultation_time = full_date - \
                                                    datetime.now(pytz.timezone('Europe/Moscow')).replace(tzinfo=None)
                        nearest_consultation = note
                    future_consultations.append(note)
    except:
        pass

    if len(future_consultations) > 0:
        message += f"üïó <b>–ë–ª–∏–∂–∞–π—à–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è: </b> {nearest_consultation[0]} | {nearest_consultation[1]} " \
                   f"- {nearest_consultation[4]}\n" \
                   f"\nüìÜ <b>–ë—É–¥—É—â–∏–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏:</b>\n"

        for consultation in future_consultations:
            message += f"{consultation[0]} | {consultation[1]} - {consultation[4]} \n"

    if len(last_consultations) > 0:
        message += "\nüìí <b>–ü—Ä–æ—à–µ–¥—à–∏–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏:</b>\n"
        for consultation in last_consultations:
            message += f"{consultation[0]} | {consultation[1]} - {consultation[4]} \n"

    if len(future_consultations) == 0 and len(last_consultations) == 0:
        message += "üß∑ –£ –≤–∞—Å –µ—â–µ –Ω–µ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π"
    return message


fullSchedule = "üòî –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –í—ã–±–µ—Ä–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥—Ä—É–≥–æ–π –¥–µ–Ω—å"

wrongService = "‚õî –í–≤–µ–¥–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —É—Å–ª—É–≥–∏"


# —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É, –∫–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –∑–∞–ø–∏—Å–∞–ª—Å—è –Ω–∞ –ø—Ä–∏–µ–º
def client_signed(full_name, date, time):
    return f"–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å!\n–ò–º—è: {full_name} \n–í—Ä–µ–º—è: {date} | {time}"


# —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ–Ω–µ—Å –∑–∞–ø–∏—Å—å
def client_rescheduled(full_name, last_date, last_time, new_date, new_time):
    return f"–ü–µ—Ä–µ–Ω–æ—Å –∑–∞–ø–∏—Å–∏!\n–ò–º—è: {full_name}\n–í—Ä–µ–º—è: {last_date} | {last_time} -> {new_date} | {new_time}"
